clc
clear all
J = [1,2,1,4,5;2,1,3,4,-1;-3,2,3,1,1;3,-4,2,1,5;6,-2,-8,2,7;2,-5,1,-3,2];
rank(J)
H = J'*J;
g = [1;3;2;-1;5];
v = g(1:2);
w = g(3:5);
x = -inv(H)*g;
B = H(1:2,1:2);
C = H(3:5,3:5);
E = H(1:2,3:5);
S = B - E*inv(C)*E';
u = v - E*inv(C)*w;
y = -inv(S)*u;
x(1:2)-y
f1 = g'*x + 0.5 * x'*H*x;
f2 = u'*y + 0.5* y'*S*y;
f1 - (f2 -0.5*w'*inv(C)*w) 